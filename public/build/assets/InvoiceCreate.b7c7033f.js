import{a9 as T,J,E,r as l,o as p,c as P,a as o,x as n,h as s,n as U,H as O,ai as K,az as Q,l as W,M as X,m as Z,d as L,e as y,p as _,q as S,am as ee,ak as ne,Y as oe,v as te,j as B,g as u,b as C,t as M,z as ie,w as ae,F as se}from"./main.9d5398e3.js";import{_ as le,a as ce,b as re,c as de,d as ue,e as me,f as ve}from"./SalesTax.6eeac271.js";import{_ as ge}from"./ExchangeRateConverter.eb624777.js";import{_ as pe}from"./CreateCustomFields.60a3284d.js";import{_ as fe}from"./TaxTypeModal.b5918a39.js";import{_ as Ie}from"./TradeInfoSection.330b9d35.js";import"./DragIcon.d907a151.js";import"./SelectNotePopup.eee062e2.js";import"./NoteModal.80345740.js";import"./payment.116d1f14.js";import"./exchange-rate.ef3d6f95.js";const _e={class:"grid grid-cols-12 gap-8 mt-6 mb-8"},be={__name:"InvoiceCreateBasicFields",props:{v:{type:Object,default:null},isLoading:{type:Boolean,default:!1},isEdit:{type:Boolean,default:!1}},setup(t){const e=T(),b=J();return E(()=>e.newInvoice.currency_id,d=>{const i=b.currencies.find(r=>r.id===d);i&&(e.newInvoice.selectedCurrency=i)}),(d,i)=>{const r=l("BaseCustomerSelectPopup"),w=l("BaseDatePicker"),v=l("BaseInputGroup"),m=l("BaseInput"),V=l("BaseMultiselect"),h=l("BaseIcon"),g=l("BaseInputGrid");return p(),P("div",_e,[o(r,{modelValue:n(e).newInvoice.customer,"onUpdate:modelValue":i[0]||(i[0]=a=>n(e).newInvoice.customer=a),valid:t.v.customer_id,"content-loading":t.isLoading,type:"invoice",class:"col-span-12 lg:col-span-5 pr-0"},null,8,["modelValue","valid","content-loading"]),o(g,{class:"col-span-12 lg:col-span-7"},{default:s(()=>[o(v,{label:d.$t("invoices.invoice_date"),"content-loading":t.isLoading,required:"",error:t.v.invoice_date.$error&&t.v.invoice_date.$errors[0].$message},{default:s(()=>[o(w,{modelValue:n(e).newInvoice.invoice_date,"onUpdate:modelValue":i[1]||(i[1]=a=>n(e).newInvoice.invoice_date=a),"content-loading":t.isLoading,"calendar-button":!0,"calendar-button-icon":"calendar"},null,8,["modelValue","content-loading"])]),_:1},8,["label","content-loading","error"]),o(v,{label:d.$t("invoices.due_date"),"content-loading":t.isLoading},{default:s(()=>[o(w,{modelValue:n(e).newInvoice.due_date,"onUpdate:modelValue":i[2]||(i[2]=a=>n(e).newInvoice.due_date=a),"content-loading":t.isLoading,"calendar-button":!0,"calendar-button-icon":"calendar"},null,8,["modelValue","content-loading"])]),_:1},8,["label","content-loading"]),o(v,{label:d.$t("invoices.invoice_number"),"content-loading":t.isLoading,error:t.v.invoice_number.$error&&t.v.invoice_number.$errors[0].$message,required:""},{default:s(()=>[o(m,{modelValue:n(e).newInvoice.invoice_number,"onUpdate:modelValue":i[3]||(i[3]=a=>n(e).newInvoice.invoice_number=a),"content-loading":t.isLoading,onInput:i[4]||(i[4]=a=>t.v.invoice_number.$touch())},null,8,["modelValue","content-loading"])]),_:1},8,["label","content-loading","error"]),o(v,{label:d.$t("settings.preferences.currency"),"content-loading":t.isLoading},{default:s(()=>[o(V,{modelValue:n(e).newInvoice.currency_id,"onUpdate:modelValue":i[5]||(i[5]=a=>n(e).newInvoice.currency_id=a),"content-loading":t.isLoading,options:n(b).currencies,label:"name","value-prop":"id",searchable:!0,"track-by":"name",class:"w-full"},null,8,["modelValue","content-loading","options"])]),_:1},8,["label","content-loading"]),o(ge,{store:n(e),"store-prop":"newInvoice",v:t.v,"is-loading":t.isLoading,"is-edit":t.isEdit,"customer-currency":n(e).newInvoice.currency_id},null,8,["store","v","is-loading","is-edit","customer-currency"]),o(v,{label:d.$t("invoices.ref_number"),"content-loading":t.isLoading},{default:s(()=>[o(m,{modelValue:n(e).newInvoice.reference_number,"onUpdate:modelValue":i[6]||(i[6]=a=>n(e).newInvoice.reference_number=a),"content-loading":t.isLoading},{left:s(a=>[o(h,{name:"HashtagIcon",class:U(a.class)},null,8,["class"])]),_:1},8,["modelValue","content-loading"])]),_:1},8,["label","content-loading"]),o(v,{label:d.$t("trade.contract_number"),"content-loading":t.isLoading},{default:s(()=>[o(m,{modelValue:n(e).newInvoice.contract_number,"onUpdate:modelValue":i[7]||(i[7]=a=>n(e).newInvoice.contract_number=a),"content-loading":t.isLoading,placeholder:d.$t("trade.contract_number_placeholder")},null,8,["modelValue","content-loading","placeholder"])]),_:1},8,["label","content-loading"])]),_:1})])}}},we={class:"flex"},ye={class:"block mt-10 invoice-foot lg:flex lg:justify-between lg:items-start"},Be={class:"relative w-full lg:w-1/2 lg:mr-4"},q="newInvoice",Ee={__name:"InvoiceCreate",setup(t){const e=T(),b=O(),d=K(),i=Q(),{t:r}=W();let w=X(),v=Z(),m=L(!1);const V=L(!1),h=L(["customer","company","customerCustom","invoice","invoiceCustom"]);let g=y(()=>e.isFetchingInvoice||e.isFetchingInitialSettings),a=y(()=>f.value?r("invoices.edit_invoice"):r("invoices.new_invoice"));const x=y(()=>b.selectedCompanySettings.sales_tax_us_enabled==="YES"&&i.salesTaxUSEnabled);let f=y(()=>w.name==="invoices.edit");const N={invoice_date:{required:_.withMessage(r("validation.required"),S)},reference_number:{maxLength:_.withMessage(r("validation.price_maxlength"),ee(255))},customer_id:{required:_.withMessage(r("validation.required"),S)},invoice_number:{required:_.withMessage(r("validation.required"),S)},exchange_rate:{required:ne(function(){return _.withMessage(r("validation.required"),S),e.showExchangeRate}),decimal:_.withMessage(r("validation.valid_exchange_rate"),oe)}},$=te(N,y(()=>e.newInvoice),{$scope:q});d.resetCustomFields(),$.value.$reset,e.resetCurrentInvoice(),e.fetchInvoiceInitialSettings(f.value),E(()=>e.newInvoice.customer,c=>{c&&c.currency?e.newInvoice.selectedCurrency=c.currency:e.newInvoice.selectedCurrency=b.selectedCompanyCurrency});async function G(){if($.value.$touch(),$.value.$invalid)return!1;m.value=!0;let c={...e.newInvoice,sub_total:e.getSubTotal,total:e.getTotal,tax:e.getTotalTax};try{const I=await(f.value?e.updateInvoice:e.addInvoice)(c);v.push(`/admin/invoices/${I.data.data.id}/view`)}catch(k){console.error(k)}m.value=!1}return(c,k)=>{const I=l("BaseBreadcrumbItem"),D=l("BaseBreadcrumb"),F=l("BaseButton"),H=l("router-link"),j=l("BaseIcon"),z=l("BasePageHeader"),R=l("BaseScrollPane"),Y=l("BasePage");return p(),P(se,null,[o(me),o(ve),o(fe),x.value&&(!n(g)||n(w).query.customer)?(p(),B(le,{key:0,store:n(e),"is-edit":n(f),"store-prop":"newInvoice",customer:n(e).newInvoice.customer},null,8,["store","is-edit","customer"])):u("v-if",!0),o(Y,{class:"relative invoice-create-page"},{default:s(()=>[C("form",{onSubmit:ae(G,["prevent"])},[o(z,{title:n(a)},{actions:s(()=>[c.$route.name==="invoices.edit"?(p(),B(H,{key:0,to:`/invoices/pdf/${n(e).newInvoice.unique_hash}`,target:"_blank"},{default:s(()=>[o(F,{class:"mr-3",variant:"primary-outline",type:"button"},{default:s(()=>[C("span",we,M(c.$t("general.view_pdf")),1)]),_:1})]),_:1},8,["to"])):u("v-if",!0),o(F,{loading:n(m),disabled:n(m),variant:"primary",type:"submit"},{left:s(A=>[n(m)?u("v-if",!0):(p(),B(j,{key:0,name:"SaveIcon",class:U(A.class)},null,8,["class"]))]),default:s(()=>[ie(" "+M(c.$t("invoices.save_invoice")),1)]),_:1},8,["loading","disabled"])]),default:s(()=>[o(D,null,{default:s(()=>[o(I,{title:c.$t("general.home"),to:"/admin/dashboard"},null,8,["title"]),o(I,{title:c.$tc("invoices.invoice",2),to:"/admin/invoices"},null,8,["title"]),c.$route.name==="invoices.edit"?(p(),B(I,{key:0,title:c.$t("invoices.edit_invoice"),to:"#",active:""},null,8,["title"])):(p(),B(I,{key:1,title:c.$t("invoices.new_invoice"),to:"#",active:""},null,8,["title"]))]),_:1})]),_:1},8,["title"]),u(" Select Customer & Basic Fields  "),o(be,{v:n($),"is-loading":n(g),"is-edit":n(f)},null,8,["v","is-loading","is-edit"]),u(" Trade / Export Information "),o(Ie,{store:n(e),"store-prop":"newInvoice","is-loading":n(g),"show-bl-awb":!0},null,8,["store","is-loading"]),o(R,null,{default:s(()=>[u(" Invoice Items "),o(ce,{currency:n(e).newInvoice.selectedCurrency,"is-loading":n(g),"item-validation-scope":q,store:n(e),"store-prop":"newInvoice"},null,8,["currency","is-loading","store"]),u(" Invoice Footer Section "),C("div",ye,[C("div",Be,[u(" Invoice Custom Notes "),o(re,{store:n(e),"store-prop":"newInvoice",fields:h.value,type:"Invoice"},null,8,["store","fields"]),u(" Invoice Custom Fields "),o(pe,{type:"Invoice","is-edit":n(f),"is-loading":n(g),store:n(e),"store-prop":"newInvoice","custom-field-scope":q,class:"mb-6"},null,8,["is-edit","is-loading","store"]),u(" Invoice Template Button"),o(de,{store:n(e),"store-prop":"newInvoice","component-name":"InvoiceTemplate","is-mark-as-default":V.value},null,8,["store","is-mark-as-default"])]),o(ue,{currency:n(e).newInvoice.selectedCurrency,"is-loading":n(g),store:n(e),"store-prop":"newInvoice","tax-popup-type":"invoice"},null,8,["currency","is-loading","store"])])]),_:1})],32)]),_:1})],64)}}};export{Ee as default};
