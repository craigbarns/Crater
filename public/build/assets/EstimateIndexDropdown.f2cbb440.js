import{a5 as z,ad as V,I as P,u as O,aa as U,N as F,l as H,M as J,m as W,r as I,o as r,j as l,h as i,x as n,a as c,z as u,t as d,g,R as f}from"./main.ecdeae84.js";const X={__name:"EstimateIndexDropdown",props:{row:{type:Object,default:null},table:{type:Object,default:null}},setup(o){const E=o,C=z("utils"),h=V(),T=P(),S=O(),p=U(),y=F(),{t:s}=H(),k=J(),b=W();async function _(e){p.openDialog({title:s("general.are_you_sure"),message:s("estimates.confirm_delete"),yesLabel:s("general.ok"),noLabel:s("general.cancel"),variant:"danger",hideNoButton:!1,size:"lg"}).then(t=>{e=e,t&&h.deleteEstimate({ids:[e]}).then(a=>{a&&(E.table&&E.table.refresh(),a.data&&b.push("/admin/estimates"),h.$patch(v=>{v.selectedEstimates=[],v.selectAllField=!1}))})})}function $(e){p.openDialog({title:s("general.are_you_sure"),message:s("estimates.confirm_conversion"),yesLabel:s("general.ok"),noLabel:s("general.cancel"),variant:"primary",hideNoButton:!1,size:"lg"}).then(t=>{t&&h.convertToInvoice(e).then(a=>{a.data&&b.push(`/admin/invoices/${a.data.data.id}/edit`)})})}async function N(e){p.openDialog({title:s("general.are_you_sure"),message:s("estimates.confirm_mark_as_sent"),yesLabel:s("general.ok"),noLabel:s("general.cancel"),variant:"primary",hideNoButton:!1,size:"lg"}).then(t=>{const a={id:e,status:"SENT"};t&&h.markAsSent(a).then(v=>{E.table&&E.table.refresh()})})}function x(e){return(e.status=="SENT"||e.status=="VIEWED")&&k.name!=="estimates.view"&&y.hasAbilities(f.SEND_ESTIMATE)}async function A(e){T.openModal({title:s("estimates.send_estimate"),componentName:"SendEstimateModal",id:e.id,data:e,variant:"lg"})}async function M(e){try{let t=await h.fetchEstimate(e.id);T.openModal({title:s("estimates.create_deposit_invoice"),componentName:"DepositInvoiceModal",id:e.id,data:t.data.data})}catch(t){console.error(t)}}async function B(e){p.openDialog({title:s("general.are_you_sure"),message:s("estimates.confirm_mark_as_accepted"),yesLabel:s("general.ok"),noLabel:s("general.cancel"),variant:"primary",hideNoButton:!1,size:"lg"}).then(t=>{const a={id:e,status:"ACCEPTED"};t&&h.markAsAccepted(a).then(v=>{E.table&&E.table.refresh()})})}async function L(e){p.openDialog({title:s("general.are_you_sure"),message:s("estimates.confirm_mark_as_rejected"),yesLabel:s("general.ok"),noLabel:s("general.cancel"),variant:"primary",hideNoButton:!1,size:"lg"}).then(t=>{const a={id:e,status:"REJECTED"};t&&h.markAsRejected(a).then(v=>{E.table&&E.table.refresh()})})}function R(){let e=`${window.location.origin}/estimates/pdf/${E.row.unique_hash}`;C.copyTextToClipboard(e),S.showNotification({type:"success",message:s("general.copied_pdf_url_clipboard")})}return(e,t)=>{const a=I("BaseIcon"),v=I("BaseButton"),m=I("BaseDropdownItem"),D=I("router-link"),j=I("BaseDropdown");return r(),l(j,null,{activator:i(()=>[n(k).name==="estimates.view"?(r(),l(v,{key:0,variant:"primary"},{default:i(()=>[c(a,{name:"DotsHorizontalIcon",class:"text-white"})]),_:1})):(r(),l(a,{key:1,class:"text-gray-500",name:"DotsHorizontalIcon"}))]),default:i(()=>[n(k).name==="estimates.view"?(r(),l(m,{key:0,onClick:R},{default:i(()=>[c(a,{name:"LinkIcon",class:"w-5 h-5 mr-3 text-gray-400 group-hover:text-gray-500"}),u(" "+d(e.$t("general.copy_pdf_url")),1)]),_:1})):g("",!0),n(y).hasAbilities(n(f).EDIT_ESTIMATE)?(r(),l(D,{key:1,to:`/admin/estimates/${o.row.id}/edit`},{default:i(()=>[c(m,null,{default:i(()=>[c(a,{name:"PencilIcon",class:"w-5 h-5 mr-3 text-gray-400 group-hover:text-gray-500"}),u(" "+d(e.$t("general.edit")),1)]),_:1})]),_:1},8,["to"])):g("",!0),n(y).hasAbilities(n(f).DELETE_ESTIMATE)?(r(),l(m,{key:2,onClick:t[0]||(t[0]=w=>_(o.row.id))},{default:i(()=>[c(a,{name:"TrashIcon",class:"w-5 h-5 mr-3 text-gray-400 group-hover:text-gray-500"}),u(" "+d(e.$t("general.delete")),1)]),_:1})):g("",!0),n(k).name!=="estimates.view"&&n(y).hasAbilities(n(f).VIEW_ESTIMATE)?(r(),l(D,{key:3,to:`estimates/${o.row.id}/view`},{default:i(()=>[c(m,null,{default:i(()=>[c(a,{name:"EyeIcon",class:"w-5 h-5 mr-3 text-gray-400 group-hover:text-gray-500"}),u(" "+d(e.$t("general.view")),1)]),_:1})]),_:1},8,["to"])):g("",!0),n(y).hasAbilities(n(f).CREATE_INVOICE)?(r(),l(m,{key:4,onClick:t[1]||(t[1]=w=>$(o.row.id))},{default:i(()=>[c(a,{name:"DocumentTextIcon",class:"w-5 h-5 mr-3 text-gray-400 group-hover:text-gray-500"}),u(" "+d(e.$t("estimates.convert_to_invoice")),1)]),_:1})):g("",!0),o.row.status!=="DRAFT"&&n(y).hasAbilities(n(f).CREATE_INVOICE)?(r(),l(m,{key:5,onClick:t[2]||(t[2]=w=>M(o.row))},{default:i(()=>[c(a,{name:"CashIcon",class:"w-5 h-5 mr-3 text-gray-400 group-hover:text-gray-500"}),u(" "+d(e.$t("estimates.create_deposit_invoice")),1)]),_:1})):g("",!0),o.row.status!=="SENT"&&n(k).name!=="estimates.view"&&n(y).hasAbilities(n(f).SEND_ESTIMATE)?(r(),l(m,{key:6,onClick:t[3]||(t[3]=w=>N(o.row.id))},{default:i(()=>[c(a,{name:"CheckCircleIcon",class:"w-5 h-5 mr-3 text-gray-400 group-hover:text-gray-500"}),u(" "+d(e.$t("estimates.mark_as_sent")),1)]),_:1})):g("",!0),o.row.status!=="SENT"&&n(k).name!=="estimates.view"&&n(y).hasAbilities(n(f).SEND_ESTIMATE)?(r(),l(m,{key:7,onClick:t[4]||(t[4]=w=>A(o.row))},{default:i(()=>[c(a,{name:"PaperAirplaneIcon",class:"w-5 h-5 mr-3 text-gray-400 group-hover:text-gray-500"}),u(" "+d(e.$t("estimates.send_estimate")),1)]),_:1})):g("",!0),x(o.row)?(r(),l(m,{key:8,onClick:t[5]||(t[5]=w=>A(o.row))},{default:i(()=>[c(a,{name:"PaperAirplaneIcon",class:"w-5 h-5 mr-3 text-gray-400 group-hover:text-gray-500"}),u(" "+d(e.$t("estimates.resend_estimate")),1)]),_:1})):g("",!0),o.row.status!=="ACCEPTED"&&n(y).hasAbilities(n(f).EDIT_ESTIMATE)?(r(),l(m,{key:9,onClick:t[6]||(t[6]=w=>B(o.row.id))},{default:i(()=>[c(a,{name:"CheckCircleIcon",class:"w-5 h-5 mr-3 text-gray-400 group-hover:text-gray-500"}),u(" "+d(e.$t("estimates.mark_as_accepted")),1)]),_:1})):g("",!0),o.row.status!=="REJECTED"&&n(y).hasAbilities(n(f).EDIT_ESTIMATE)?(r(),l(m,{key:10,onClick:t[7]||(t[7]=w=>L(o.row.id))},{default:i(()=>[c(a,{name:"XCircleIcon",class:"w-5 h-5 mr-3 text-gray-400 group-hover:text-gray-500"}),u(" "+d(e.$t("estimates.mark_as_rejected")),1)]),_:1})):g("",!0)]),_:1})}}};export{X as _};
